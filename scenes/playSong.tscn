[gd_scene load_steps=14 format=2]

[ext_resource path="res://assets/songs/caramel-dancing.mp3" type="AudioStream" id=1]
[ext_resource path="res://scripts/PlaySong.gd" type="Script" id=2]
[ext_resource path="res://scenes/beatWall.tscn" type="PackedScene" id=3]
[ext_resource path="res://assets/models/table.glb" type="PackedScene" id=4]
[ext_resource path="res://assets/models/potCastIron.glb" type="PackedScene" id=5]

[sub_resource type="PanoramaSky" id=1]

[sub_resource type="Environment" id=2]
background_mode = 4
background_sky = SubResource( 1 )
background_color = Color( 0.894118, 0.631373, 0.631373, 1 )
background_canvas_max_layer = -1

[sub_resource type="Shader" id=5]
code = "shader_type canvas_item;

uniform sampler2D noise_img;
uniform float speed = 1.0;

void fragment(){
	vec2 uv1 = vec2(UV.x + TIME * speed, UV.y);
	vec2 uv2 = vec2(UV.x - TIME * speed, UV.y);
	vec2 uv3 = vec2(UV.x, UV.y + TIME * speed);
	
	
	float noise_r = texture(noise_img, uv1).r;
	float noise_g = texture(noise_img, uv2).g;
	float noise_b = texture(noise_img, uv3).b;
	
	
	vec3 new_color = vec3(noise_r, noise_g, noise_b);
	
	COLOR.rgb = new_color;
	COLOR.a = texture(TEXTURE, UV).a;
}"

[sub_resource type="OpenSimplexNoise" id=6]

[sub_resource type="NoiseTexture" id=7]
seamless = true
noise = SubResource( 6 )

[sub_resource type="ShaderMaterial" id=8]
shader = SubResource( 5 )
shader_param/speed = 0.1
shader_param/noise_img = SubResource( 7 )

[sub_resource type="OpenSimplexNoise" id=3]

[sub_resource type="NoiseTexture" id=4]
seamless = true
noise = SubResource( 3 )

[node name="Spatial" type="Spatial"]
script = ExtResource( 2 )

[node name="Timer" type="Timer" parent="."]

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 1 )

[node name="time" type="Label" parent="."]
margin_right = 40.0
margin_bottom = 14.0
text = "0"

[node name="InterpolatedCamera" type="InterpolatedCamera" parent="."]
transform = Transform( 1, 0, 0, 0, 0.87467, 0.484718, 0, -0.484718, 0.87467, 0, 4.22712, 14.201 )
fov = 128.229

[node name="BeatWallS" parent="." instance=ExtResource( 3 )]
transform = Transform( 6, 0, 0, 0, 6, 0, 0, 0, 6, -0.5, 0, 12.295 )

[node name="BeatWallD" parent="." instance=ExtResource( 3 )]
transform = Transform( 6, 0, 0, 0, 6, 0, 0, 0, 6, -5, 0, 12.283 )

[node name="BeatWallA" parent="." instance=ExtResource( 3 )]
transform = Transform( 6, 0, 0, 0, 6, 0, 0, 0, 6, 5, 0, 12.295 )

[node name="table" parent="." instance=ExtResource( 4 )]
transform = Transform( 5, 0, 0, 0, 5, 0, 0, 0, 7, 25.8864, 0, 12.244 )

[node name="potCastIron" parent="." instance=ExtResource( 5 )]
transform = Transform( 6, 0, 0, 0, 6, 0, 0, 0, 6, 25.7145, 3.62647, 12.3359 )

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( 0.999724, 0.0235074, 9.06906e-10, -0.017802, 0.757082, 0.653077, 0.0153522, -0.652897, 0.757291, 0, 11.8175, 13.0362 )
light_color = Color( 0.964706, 1, 0.564706, 1 )
light_bake_mode = 2
shadow_enabled = true
shadow_color = Color( 0.152941, 0.266667, 0.517647, 1 )

[node name="DirectionalLight2" type="DirectionalLight" parent="."]
transform = Transform( 0.195611, 0.643195, -0.740295, -0.017802, 0.757082, 0.653077, 0.98052, -0.11457, 0.159544, 19.0925, 8.35929, 13.0362 )
light_color = Color( 0.964706, 1, 0.564706, 1 )
light_bake_mode = 2
shadow_enabled = true
shadow_color = Color( 0.152941, 0.266667, 0.517647, 1 )

[node name="CSGBox" type="CSGBox" parent="."]
transform = Transform( 8.17725, 0, 0, 0, 0.0858369, 0, 0, 0, 10.4557, 0, -0.606925, 5.30532 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 2 )

[node name="CanvasLayer" type="CanvasLayer" parent="."]
layer = -1

[node name="Sprite" type="Sprite" parent="CanvasLayer"]
material = SubResource( 8 )
position = Vector2( 698.5, 589 )
scale = Vector2( 2.72852, 2.30078 )
texture = SubResource( 4 )

[connection signal="finished" from="AudioStreamPlayer" to="." method="_on_AudioStreamPlayer_finished"]
